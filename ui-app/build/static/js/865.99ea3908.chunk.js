"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[865],{12117:(e,s,n)=>{n.d(s,{Z:()=>g});var t=n(72791),r=n(55087),o=n(77618),l=n(22618),a=n(6265),c=n(30734),i=n(45471),d=n(27316),u=n(71987),m=n(95294),h=n(40368),p=n(80184);const x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{llmConfig:{num_beams:1,do_sample:!0,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1,...e.llmConfig||{}},requestConfig:{onlyNewTokens:!0,streamResponse:!0,...e.requestConfig||{}}}},g=e=>{let{onChange:s=(()=>{}),showStream:n=!1,defaultConfig:g={},config:j={}}=e;const[b,v]=(0,t.useState)(x(g));(0,t.useEffect)((()=>{y({})}),[]);const C=()=>({...b.llmConfig,...(null===j||void 0===j?void 0:j.llmConfig)||{}}),k=()=>({...b.requestConfig,...(null===j||void 0===j?void 0:j.requestConfig)||{}}),y=e=>{const n={llmConfig:{...b.llmConfig,...e.llmConfig},requestConfig:{...b.requestConfig,...e.requestConfig}};v(n),s(n)},_=e=>{y({llmConfig:e})},w=e=>{y({requestConfig:e})};return(0,p.jsxs)(r.x,{className:"mb-3 ",children:[(0,p.jsxs)(o.b,{children:["Generation Config:",(0,p.jsx)(l.u,{color:"secondary",size:"sm",className:"float-end",onClick:()=>{const e=x(g);v(e),s(e)},children:"reset defaults"})]}),(0,p.jsxs)(a.s,{children:[(0,p.jsx)("small",{children:(0,p.jsx)("br",{})}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Temperature - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"temperature",type:"number",value:C().temperature,onChange:e=>{const s=parseFloat(e.target.value)||0;_({temperature:s<0?0:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Max new Tokens - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"max_new_tokens",type:"number",value:C().max_new_tokens,onChange:e=>{const s=parseInt(e.target.value)||0;_({max_new_tokens:s<1?1:s})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Number of Beams - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"num_beams",type:"number",value:C().num_beams,onChange:e=>{const s=parseInt(e.target.value)||0;_({num_beams:s<1?1:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsx)(d.Y,{className:"mb-3",children:(0,p.jsx)(h.E,{style:{cursor:"pointer"},checked:C().do_sample,onChange:e=>_({do_sample:!!e.target.checked}),className:"mt-2",type:"checkbox",id:"doSample",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Do sample ( Bool )"})})})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Top 'P' - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"top_p",type:"number",value:C().top_p,onChange:e=>{const s=parseFloat(e.target.value)||0;_({top_p:s<0?0:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Top 'K' - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"top_k",type:"number",value:C().top_k,onChange:e=>{const s=parseInt(e.target.value)||0;_({top_k:s<0?0:s})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Repetition penalty - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"repetition_penalty",type:"number",value:C().repetition_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;_({repetition_penalty:s<1e-6?1e-6:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Length penalty - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"length_penalty",type:"number",value:C().length_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;_({length_penalty:s<0?0:s})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsx)(h.E,{style:{cursor:"pointer"},checked:k().onlyNewTokens,onChange:e=>w({onlyNewTokens:e.target.checked}),className:"mt-2",type:"checkbox",id:"onlyNewTokensCheck",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Only return new tokens ( or include prompt )"})})}),(0,p.jsx)(i.b,{cm:6,children:n&&(0,p.jsx)(h.E,{style:{cursor:"pointer"},checked:k().streamResponse,onChange:e=>w({streamResponse:e.target.checked}),className:"mt-2",type:"checkbox",id:"isStreamResponse",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Stream tokens as they are being generated ( or all at once )"})})})]}),(0,p.jsx)("div",{className:"invalid-feedback d-block",children:1!==C().num_beams&&"Multiple beams do not support streaming!"})]})]})}},30218:(e,s,n)=>{n.d(s,{Z:()=>g});var t=n(72791),r=n(6332),o=n(55087),l=n(77618),a=n(30734),c=n(45471),i=n(22618),d=n(6265),u=n(84135),m=n(33906),h=n(50436),p=n(59434),x=n(80184);const g=e=>{let{requestId:s,response:n}=e;const[g,j]=(0,t.useState)(!1),b=(0,p.v9)((e=>{let{theme:s}=e;return"auto"===s?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":s})),v={code:e=>{let{node:s,...n}=e;return(0,x.jsx)("span",{children:(0,x.jsx)(u.Z,{language:n.language,style:"dark"===b?m.Z:h.Z,children:n.children})})}};return(0,x.jsxs)(o.x,{className:"mb-5 ",children:[(0,x.jsx)(l.b,{children:(0,x.jsxs)(a.r,{children:[(0,x.jsxs)(c.b,{sm:8,children:[(0,x.jsx)("div",{children:"Response to requestID:"}),(0,x.jsx)("small",{children:s})]}),(0,x.jsx)(c.b,{sm:4,children:(0,x.jsx)(i.u,{size:"sm",color:g?"info":"light",className:"float-end mt-2",onClick:()=>j(!g),children:g?"View markdown":"View raw response"})})]})}),(0,x.jsx)(d.s,{children:g?(0,x.jsx)("span",{className:"markdown-llm",children:n}):(0,x.jsx)(r.U,{components:v,skipHtml:!0,className:"markdown-llm",children:n.replace(/ /g,"\xa0")})})]})}},99840:(e,s,n)=>{n.d(s,{Z:()=>o});var t=n(72791),r=n(80184);const o=function(){const[e,s]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=(new Date).getTime(),n=setInterval((()=>{s((s=>(new Date).getTime()-e))}),99);return()=>clearInterval(n)}),[]),(0,r.jsx)(r.Fragment,{children:(e/1e3).toFixed(3)})}},80865:(e,s,n)=>{n.r(s),n.d(s,{default:()=>f});var t=n(72791),r=n(12117),o=n(55087),l=n(77618),a=n(22618),c=n(54261),i=n(80184);const d=e=>{switch(e){case"connecting":return"yellow";case"connected":return"green";case"closed":return"gray";case"error":return"red";default:return""}},u={},m=e=>{let{wsUrl:s,onConnecting:n=(()=>{}),onConnect:r=(()=>{}),onError:m=(()=>{}),onClose:h=(()=>{}),onMessage:p=(()=>{}),onStatus:x=(()=>{})}=e;const[g,j]=(0,t.useState)((0,c.Z)()),[b,v]=(0,t.useState)(null),[C,k]=(0,t.useState)("connecting");u[g]={onConnecting:n,onConnect:r,onError:m,onClose:h,onMessage:p,onStatus:x};const y=e=>{var s;let n=e.data;try{n=JSON.parse(e.data)}catch(t){}null===(s=u[g])||void 0===s||s.onMessage(n,e)},_=e=>{e&&(e.removeEventListener("message",y),e.close(),v(null))},w=e=>{k(e),x(e)};return(0,t.useEffect)((()=>{var e;const n=new WebSocket(s);return w("connecting"),n.status="connecting",v(n),null===(e=u[g])||void 0===e||e.onConnecting(n,g),n.addEventListener("open",(function(e){var s;w("connected"),n.status="connected",null===(s=u[g])||void 0===s||s.onConnect(n,g)})),n.addEventListener("close",(function(e){var s;"connecting"!==n.status&&"closing"!==n.status&&w("closed"),n.status="closed",null===(s=u[g])||void 0===s||s.onClose(n,g)})),n.addEventListener("error",(function(e){var s;n.status="error",w("error"),null===(s=u[g])||void 0===s||s.onError(n,g)})),n.addEventListener("message",y),()=>{delete u[g],_(b)}}),[g]),(0,i.jsx)(o.x,{className:"mb-3 ",children:(0,i.jsxs)(l.b,{style:{lineHeight:"2rem"},children:["Websocket Status :\xa0",(0,i.jsx)("strong",{style:{color:d(C)},children:C}),"connected"===C&&(0,i.jsx)(a.u,{size:"sm",color:"danger",className:"float-end ms-3",onClick:()=>_(b),children:"Close"}),("error"===C||"connected"===C)&&(0,i.jsx)(a.u,{size:"sm",color:"secondary",className:"float-end ms-3",onClick:()=>{b.status="closing",j((0,c.Z)())},children:"Reconnect"}),("closed"===C||"connecting"===C)&&(0,i.jsx)(a.u,{size:"sm",disabled:"connecting"===C,color:"success",className:"float-end ms-3",onClick:()=>j((0,c.Z)()),children:"closed"===C?"Connect":"Connecting..."})]})})};var h=n(30734),p=n(45471),x=n(27316),g=n(71987),j=n(95294),b=n(25512),v=n(26775),C=n(52424),k=n(40368),y=n(30218),_=n(99840);const w="".concat({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL||"","/api/ws").replace(/^http/i,"ws"),f=()=>{const[e,s]=(0,t.useState)({}),[n,l]=(0,t.useState)(null),[d,u]=(0,t.useState)("connecting"),[f,S]=(0,t.useState)([{prompt:"[INST] Generate a very long poem about 1000 cats [/INST]\n\n",request_id:(0,c.Z)(),response:"",id:(0,c.Z)()}]),[N,E]=(0,t.useState)(!1),[T,q]=(0,t.useState)(!1),[I,R]=(0,t.useState)(!1),[L,Z]=(0,t.useState)(!1),[F,D]=(0,t.useState)(!1),[O,A]=(0,t.useState)(!1),[P,Y]=(0,t.useState)([]),[M,W]=(0,t.useState)(0),[G,U]=(0,t.useState)(0),[z,H]=(0,t.useState)(0),[B,K]=(0,t.useState)(!0),[V,J]=(0,t.useState)(0),[Q,X]=(0,t.useState)("");(0,t.useEffect)((()=>{!T||!O||I||N||V?E(!1):ne()}),[G]);const $=()=>{l(null),se()},ee=(e,s)=>{const n=f.findIndex((s=>s.id===e));f[n]={...f[n],...s},S([...f])},se=()=>{E(!0),D(!1),R(!1),Z(!1)},ne=s=>{var t,r;n&&(R(!0),O||(Y([]),S([...f.map((e=>(e.response="",e)))])),n.send(JSON.stringify({prompts:f.map((e=>{let{prompt:s,request_id:n}=e;return{request_id:n,prompt:s}})),generation_config:null===e||void 0===e?void 0:e.llmConfig,only_new_tokens:!(null===e||void 0===e||null===(t=e.requestConfig)||void 0===t||!t.onlyNewTokens),stream_response:!(null===e||void 0===e||null===(r=e.requestConfig)||void 0===r||!r.streamResponse)})),O?window.scrollLock=null!==s&&void 0!==s?s:window.scrollLock:window.setTimeout((()=>window.scrollLock=null!==s&&void 0!==s?s:window.scrollLock),250))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m,{wsUrl:w,onMessage:s=>{if(!s.length)return void console.log("Got empty events array, this is normal...");const n=s[0].type,t=s.reduce(((e,s)=>(e[s.request_id]=s,e)),{});switch(n){case"ACCEPTED":D(!0);break;case"STARTED":H((new Date).getTime()),D(!1);break;case"INITIALIZED":case"PROGRESS":I&&(R(!1),Z(!0)),S([...f.map((e=>{var s;return e.response+=(null===(s=t[e.request_id])||void 0===s?void 0:s.text)||"",e}))]);break;case"COMPLETE":R(!1),Z(!1),L||S([...f.map((s=>{var n,r,o;null!==e&&void 0!==e&&null!==(n=e.requestConfig)&&void 0!==n&&n.onlyNewTokens?s.response+=(null===(r=t[s.request_id])||void 0===r?void 0:r.text)||"":s.response=(null===(o=t[s.request_id])||void 0===o?void 0:o.text)||"";return s}))]);const r=s.every((e=>{let{is_eos:s}=e;return s}));A(!r);const o=(new Date).getTime()-z;W(o),Y([...P,o]),U(G+1);break;case"ERROR":R(!1),Z(!1),D(!1),J(!0),X(s[0].error);break;default:console.warn("Type ".concat(n," is not handled!"))}},onConnect:(e,s)=>{l(e)},onStatus:e=>u(e),onClose:$,onError:$}),(0,i.jsx)(r.Z,{config:e,onChange:e=>s(e),showStream:!0}),(0,i.jsx)(h.r,{children:f.map(((e,s)=>{let{prompt:n,request_id:t,id:r}=e;return(0,i.jsx)(p.b,{sm:1===f.length?12:6,className:"mt-4",children:(0,i.jsxs)(o.x,{children:[(0,i.jsxs)(x.Y,{children:[(0,i.jsx)(g.w,{children:"RequestId"}),(0,i.jsx)(j.j,{disabled:I||O,placeholder:"request_id",type:"text",value:t,onChange:e=>ee(r,{request_id:e.target.value})}),s>0&&(0,i.jsx)(a.u,{color:"danger",disabled:O,onClick:()=>(e=>{const s=f.findIndex((s=>s.id===e));f.splice(s,1),S([...f])})(r),children:(0,i.jsx)("strong",{children:"Clear"})})]}),(0,i.jsx)(b.P,{placeholder:"[INST] Generate a very long poem about 1000 cats [/INST]\\n\\n",disabled:I||O,value:n,invalid:!!V||!n,onChange:e=>ee(r,{prompt:e.target.value}),id:"exampleFormControlTextarea1",rows:10})]})},"batch-prompt-".concat(r))}))}),!!V&&(0,i.jsx)("div",{className:"invalid-feedback d-block mt-2",children:V&&(Q||"Error generating a response, check your console")}),P.length?(0,i.jsx)(v.L,{htmlFor:"exampleFormControlTextarea1",className:"mt-3",children:(0,i.jsx)("strong",{children:"Response time history: "})}):"",(0,i.jsx)("div",{className:"pb-3",style:{overflow:"auto",whiteSpace:"nowrap"},children:P.length?P.map(((e,s)=>(0,i.jsxs)(C.C,{color:"dark",shape:"rounded-pill",className:"me-2",children:[(e/1e3).toFixed(3)," s"]},"badge-".concat(s,"-").concat(e)))):""}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(a.u,{color:"primary",disabled:I||L||O,onClick:()=>{S([...f,{request_id:(0,c.Z)(),prompt:"",id:(0,c.Z)()}])},children:[" ","+"," "]}),(0,i.jsx)(a.u,{className:"ms-3",color:"primary",disabled:"connected"!==d||I||L||!f.every((e=>{let{prompt:s}=e;return!!s})),onClick:()=>ne(B&&f.length<3),children:N&&(I||L||F)?"Stopping...":F?"In Queue...":I?"Waiting...":L?"Streaming...":O?"Continue":"Send Prompt"}),O&&!I&&!L&&" or ",O&&!I&&!L&&(0,i.jsx)(a.u,{color:"secondary",disabled:I||L,onClick:()=>{E(!1),S(f.map((e=>({...e,request_id:(0,c.Z)(),response:""})))),Y([]),J(0),X(""),R(!1),D(!1),A(!1)},children:"reset"}),I||L?(0,i.jsxs)(v.L,{children:[(0,i.jsx)("strong",{children:"\xa0\xa0Segment time:\xa0"}),(0,i.jsx)(_.Z,{})," seconds"]}):M?(0,i.jsxs)(v.L,{children:[(0,i.jsx)("strong",{children:"\xa0\xa0Generation:\xa0"}),P.reduce(((e,s)=>e+s),0)/1e3," seconds"]}):"",(0,i.jsx)(a.u,{color:"secondary",className:"float-end ms-3",disabled:!T,onClick:()=>E(!0),children:"Stop"}),(0,i.jsx)(a.u,{color:"secondary",className:"float-end",disabled:!I&&!L,onClick:se,children:"Abort"}),"\xa0\xa0"]}),"connected"!==d&&(0,i.jsx)("div",{className:"valid-feedback d-block mt-1 mb-3",children:"Websocket is not connected"}),(0,i.jsx)(k.E,{style:{cursor:"pointer"},checked:B&&f.length<3,disabled:f.length>2,onChange:e=>K(e.target.checked),className:"mt-2",type:"checkbox",id:"setAutoScroll",label:(0,i.jsx)("span",{style:{cursor:"pointer"},children:"Auto scroll to follow the generated response"})}),(0,i.jsx)(k.E,{style:{cursor:"pointer"},checked:T,disabled:I||L,onChange:e=>q(e.target.checked),className:"mt-2",type:"checkbox",id:"autoContinueCheck",label:(0,i.jsx)("span",{style:{cursor:"pointer"},children:"Automatically continue prompt generation when didnt reach EOS"})}),(0,i.jsx)(h.r,{children:f.map((e=>{let{id:s,request_id:n,response:t}=e;return(0,i.jsx)(p.b,{sm:1===f.length?12:6,className:"mt-4",children:t&&(0,i.jsx)(y.Z,{requestId:n,response:t||""})},"response-".concat(s))}))})]})}}}]);
//# sourceMappingURL=865.99ea3908.chunk.js.map