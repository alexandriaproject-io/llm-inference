"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[58],{12117:(e,s,n)=>{n.d(s,{Z:()=>g});var t=n(72791),l=n(55087),r=n(77618),o=n(22618),a=n(6265),c=n(30734),i=n(45471),d=n(27316),h=n(71987),m=n(95294),u=n(40368),p=n(80184);const x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{llmConfig:{num_beams:1,do_sample:!0,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1,...e.llmConfig||{}},requestConfig:{onlyNewTokens:!0,streamResponse:!0,...e.requestConfig||{}}}},g=e=>{let{onChange:s=(()=>{}),showStream:n=!1,defaultConfig:g={},config:j={}}=e;const[b,w]=(0,t.useState)(x(g));(0,t.useEffect)((()=>{_({})}),[]);const y=()=>({...b.llmConfig,...(null===j||void 0===j?void 0:j.llmConfig)||{}}),k=()=>({...b.requestConfig,...(null===j||void 0===j?void 0:j.requestConfig)||{}}),_=e=>{const n={llmConfig:{...b.llmConfig,...e.llmConfig},requestConfig:{...b.requestConfig,...e.requestConfig}};w(n),s(n)},C=e=>{_({llmConfig:e})},f=e=>{_({requestConfig:e})};return(0,p.jsxs)(l.x,{className:"mb-3 ",children:[(0,p.jsxs)(r.b,{children:["Generation Config:",(0,p.jsx)(o.u,{color:"secondary",size:"sm",className:"float-end",onClick:()=>{const e=x(g);w(e),s(e)},children:"reset defaults"})]}),(0,p.jsxs)(a.s,{children:[(0,p.jsx)("small",{children:(0,p.jsx)("br",{})}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Temperature - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"temperature",type:"number",value:y().temperature,onChange:e=>{const s=parseFloat(e.target.value)||0;C({temperature:s<0?0:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Max new Tokens - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"max_new_tokens",type:"number",value:y().max_new_tokens,onChange:e=>{const s=parseInt(e.target.value)||0;C({max_new_tokens:s<1?1:s})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Number of Beams - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"num_beams",type:"number",value:y().num_beams,onChange:e=>{const s=parseInt(e.target.value)||0;C({num_beams:s<1?1:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsx)(d.Y,{className:"mb-3",children:(0,p.jsx)(u.E,{style:{cursor:"pointer"},checked:y().do_sample,onChange:e=>C({do_sample:!!e.target.checked}),className:"mt-2",type:"checkbox",id:"doSample",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Do sample ( Bool )"})})})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Top 'P' - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"top_p",type:"number",value:y().top_p,onChange:e=>{const s=parseFloat(e.target.value)||0;C({top_p:s<0?0:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Top 'K' - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"top_k",type:"number",value:y().top_k,onChange:e=>{const s=parseInt(e.target.value)||0;C({top_k:s<0?0:s})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Repetition penalty - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"repetition_penalty",type:"number",value:y().repetition_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;C({repetition_penalty:s<1e-6?1e-6:s})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(h.w,{style:{width:205},children:["Length penalty - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"length_penalty",type:"number",value:y().length_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;C({length_penalty:s<0?0:s})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsx)(u.E,{style:{cursor:"pointer"},checked:k().onlyNewTokens,onChange:e=>f({onlyNewTokens:e.target.checked}),className:"mt-2",type:"checkbox",id:"onlyNewTokensCheck",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Only return new tokens ( or include prompt )"})})}),(0,p.jsx)(i.b,{cm:6,children:n&&(0,p.jsx)(u.E,{style:{cursor:"pointer"},checked:k().streamResponse,onChange:e=>f({streamResponse:e.target.checked}),className:"mt-2",type:"checkbox",id:"isStreamResponse",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Stream tokens as they are being generated ( or all at once )"})})})]}),(0,p.jsx)("div",{className:"invalid-feedback d-block",children:1!==y().num_beams&&"Multiple beams do not support streaming!"})]})]})}},30218:(e,s,n)=>{n.d(s,{Z:()=>g});var t=n(72791),l=n(6332),r=n(55087),o=n(77618),a=n(30734),c=n(45471),i=n(22618),d=n(6265),h=n(84135),m=n(33906),u=n(50436),p=n(59434),x=n(80184);const g=e=>{let{requestId:s,response:n}=e;const[g,j]=(0,t.useState)(!1),b=(0,p.v9)((e=>{let{theme:s}=e;return"auto"===s?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":s})),w={code:e=>{let{node:s,...n}=e;return(0,x.jsx)("span",{children:(0,x.jsx)(h.Z,{language:n.language,style:"dark"===b?m.Z:u.Z,children:n.children})})}};return(0,x.jsxs)(r.x,{className:"mb-5 ",children:[(0,x.jsx)(o.b,{children:(0,x.jsxs)(a.r,{children:[(0,x.jsxs)(c.b,{sm:8,children:[(0,x.jsx)("div",{children:"Response to requestID:"}),(0,x.jsx)("small",{children:s})]}),(0,x.jsx)(c.b,{sm:4,children:(0,x.jsx)(i.u,{size:"sm",color:g?"info":"light",className:"float-end mt-2",onClick:()=>j(!g),children:g?"View markdown":"View raw response"})})]})}),(0,x.jsx)(d.s,{children:g?(0,x.jsx)("span",{className:"markdown-llm",children:n}):(0,x.jsx)(l.U,{components:w,skipHtml:!0,className:"markdown-llm",children:n.replace(/ /g,"\xa0")})})]})}},99840:(e,s,n)=>{n.d(s,{Z:()=>r});var t=n(72791),l=n(80184);const r=function(){const[e,s]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=(new Date).getTime(),n=setInterval((()=>{s((s=>(new Date).getTime()-e))}),99);return()=>clearInterval(n)}),[]),(0,l.jsx)(l.Fragment,{children:(e/1e3).toFixed(3)})}},53058:(e,s,n)=>{n.r(s),n.d(s,{default:()=>b});var t=n(72791),l=n(48113),r=n(26775),o=n(25512),a=n(2328),c=n(52424),i=n(22618),d=n(40368),h=n(99840),m=n(54261),u=n(12117),p=n(30218),x=n(80184);const g="".concat({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL||"","/api/generate-one");function j(e,s,n){return e.endsWith(s)?e.slice(0,-s.length)+n:e}const b=()=>{const[e,s]=(0,t.useState)((0,m.Z)()),[n,b]=(0,t.useState)("[INST] Generate a very long poem about 1000 cats [/INST]\n\n"),[w,y]=(0,t.useState)(!1),[k,_]=(0,t.useState)(!1),[C,f]=(0,t.useState)(!0),[v,S]=(0,t.useState)(""),[N,T]=(0,t.useState)(null),[E,F]=(0,t.useState)(0),[I,q]=(0,t.useState)([]),[R,L]=(0,t.useState)(0),[A,D]=(0,t.useState)(""),[Z,O]=(0,t.useState)(!1),[P,Y]=(0,t.useState)(!1),[W,B]=(0,t.useState)(!1),[G,H]=(0,t.useState)({});(0,t.useEffect)((()=>{!k||!W||P||Z||w||R?y(!1):K()}),[E]);const K=async s=>{W?window.scrollLock=null!==s&&void 0!==s?s:window.scrollLock:(S(""),window.setTimeout((()=>window.scrollLock=null!==s&&void 0!==s?s:window.scrollLock),250)),O(!0),Y(!1),y(!1),D(""),L(0),F(0);let t="";var l;W?t=null!==G&&void 0!==G&&null!==(l=G.requestConfig)&&void 0!==l&&l.onlyNewTokens?v:"":q([]);let r="";try{var o,a;const{responseTime:s,response:l}=await async function(e,s){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const l=(new Date).getTime(),r=new AbortController,o=r.signal,a=await fetch(e,{method:"POST",body:JSON.stringify(s),signal:o});t(r);const c=a.body.getReader();for(;;){const{done:e,value:s}=await c.read();if(e)break;n((new TextDecoder).decode(s))}return{response:a,responseTime:(new Date).getTime()-l}}(g,{request_id:e,prompt:n,only_new_tokens:!(null===G||void 0===G||null===(o=G.requestConfig)||void 0===o||!o.onlyNewTokens),stream_response:!(null===G||void 0===G||null===(a=G.requestConfig)||void 0===a||!a.streamResponse),generation_config:G.llmConfig},(e=>{r=e,t+=e,O(!1),Y(!0),S(t)}),(e=>T(e)));200!==l.status?(L(1),window.scrollLock=!1,C&&window.scrollTo(0,0),S(j(t,r,"")),D(r)):q(W?[...I,s]:[s]),F(s)}catch(c){"AbortError"===c.name?L(2):(console.error(c),L(1),window.scrollLock=!1,C&&window.scrollTo(0,0),S(j(t,r,"")),D(r)),T(null),O(!1),Y(!1),y(!1)}finally{T(null),O(!1),Y(!1);const e=t.trimEnd().endsWith("</s>");B(!e),e&&y(!1)}};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(l.l,{className:"pb-5",children:[(0,x.jsx)(u.Z,{config:G,onChange:e=>H(e),showStream:!0}),(0,x.jsxs)("div",{className:"mb-3",children:[(0,x.jsxs)(r.L,{htmlFor:"exampleFormControlTextarea1",children:[(0,x.jsx)("strong",{children:"Write your prompt "}),"- ",(0,x.jsxs)("small",{children:["RequestID: ",e]})]}),(0,x.jsx)(o.P,{placeholder:"[INST] Generate a very long poem about 1000 cats [/INST]\\n\\n",disabled:Z||P||W,value:n,invalid:!!R,onChange:e=>b(e.target.value),id:"exampleFormControlTextarea1",rows:10}),(0,x.jsx)(a.C,{invalid:!0,children:2===R?"Aborting might cause some data to be lost, its best to reset after aborting!":A||"Error generating a response, check your console"})]}),I.length?(0,x.jsx)(r.L,{htmlFor:"exampleFormControlTextarea1",children:(0,x.jsx)("strong",{children:"Response time history: "})}):"",(0,x.jsx)("div",{className:"pb-3",style:{overflow:"auto",whiteSpace:"nowrap"},children:I.length?I.map(((e,s)=>(0,x.jsxs)(c.C,{color:"dark",shape:"rounded-pill",className:"me-2",children:[(e/1e3).toFixed(3)," s"]},"badge-".concat(s,"-").concat(e)))):""}),(0,x.jsxs)("div",{className:"mb-3 ",children:[(0,x.jsx)(i.u,{color:"primary",disabled:Z||P||!n,onClick:()=>K(C),children:w&&(Z||P)?"Stopping...":Z?"Waiting...":P?"Streaming...":W?"Continue":"Send Prompt"}),W&&!Z&&!P&&" or ",!Z&&!P&&W&&(0,x.jsx)(i.u,{color:"secondary",disabled:Z||P,onClick:()=>{s((0,m.Z)()),y(!1),S(""),T(null),F(0),q([]),L(0),D(""),O(!1),Y(!1),B(!1)},children:"reset"}),Z||P?(0,x.jsxs)(r.L,{children:[(0,x.jsx)("strong",{children:"\xa0\xa0Segment time:\xa0"}),(0,x.jsx)(h.Z,{})," seconds"]}):E?(0,x.jsxs)(r.L,{children:[(0,x.jsx)("strong",{children:"\xa0\xa0Generation:\xa0"}),I.reduce(((e,s)=>e+s),0)/1e3," seconds"]}):"",(0,x.jsx)(i.u,{color:"secondary",className:"float-end ms-3",disabled:!k,onClick:()=>y(!0),children:"Stop"}),(0,x.jsx)(i.u,{color:"secondary",className:"float-end",disabled:!Z&&!P,onClick:()=>{y(!0),N&&N.abort()},children:"Abort"}),"\xa0\xa0"]}),(0,x.jsx)(d.E,{style:{cursor:"pointer"},checked:C,onChange:e=>f(e.target.checked),className:"mt-2",type:"checkbox",id:"setAutoScroll",label:(0,x.jsx)("span",{style:{cursor:"pointer"},children:"Auto scroll to follow the generated response"})}),(0,x.jsx)(d.E,{style:{cursor:"pointer"},checked:k,disabled:Z||P,onChange:e=>_(e.target.checked),className:"mt-2",type:"checkbox",id:"autoContinueCheck",label:(0,x.jsx)("span",{style:{cursor:"pointer"},children:"Automatically continue prompt generation when didnt reach EOS"})})]}),v&&(0,x.jsx)(p.Z,{requestId:e,response:v})]})}}}]);
//# sourceMappingURL=58.435066fc.chunk.js.map