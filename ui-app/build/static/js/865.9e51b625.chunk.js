"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[865],{12117:(e,n,s)=>{s.d(n,{Z:()=>g});var t=s(72791),o=s(55087),r=s(77618),l=s(22618),a=s(6265),c=s(30734),i=s(45471),d=s(27316),u=s(71987),m=s(95294),h=s(40368),p=s(80184);const x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{llmConfig:{num_beams:1,do_sample:!0,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1,...e.llmConfig||{}},requestConfig:{onlyNewTokens:!0,streamResponse:!0,...e.requestConfig||{}}}},g=e=>{let{onChange:n=(()=>{}),showStream:s=!1,defaultConfig:g={},config:j={}}=e;const[v,b]=(0,t.useState)(x(g));(0,t.useEffect)((()=>{y({})}),[]);const C=()=>({...v.llmConfig,...(null===j||void 0===j?void 0:j.llmConfig)||{}}),k=()=>({...v.requestConfig,...(null===j||void 0===j?void 0:j.requestConfig)||{}}),y=e=>{const s={llmConfig:{...v.llmConfig,...e.llmConfig},requestConfig:{...v.requestConfig,...e.requestConfig}};b(s),n(s)},_=e=>{y({llmConfig:e})},w=e=>{y({requestConfig:e})};return(0,p.jsxs)(o.x,{className:"mb-3 ",children:[(0,p.jsxs)(r.b,{children:["Generation Config:",(0,p.jsx)(l.u,{color:"secondary",size:"sm",className:"float-end",onClick:()=>{const e=x(g);b(e),n(e)},children:"reset defaults"})]}),(0,p.jsxs)(a.s,{children:[(0,p.jsx)("small",{children:(0,p.jsx)("br",{})}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Temperature - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"temperature",type:"number",value:C().temperature,onChange:e=>{const n=parseFloat(e.target.value)||0;_({temperature:n<0?0:n})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Max new Tokens - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"max_new_tokens",type:"number",value:C().max_new_tokens,onChange:e=>{const n=parseInt(e.target.value)||0;_({max_new_tokens:n<1?1:n})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Number of Beams - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"num_beams",type:"number",value:C().num_beams,onChange:e=>{const n=parseInt(e.target.value)||0;_({num_beams:n<1?1:n})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsx)(d.Y,{className:"mb-3",children:(0,p.jsx)(h.E,{style:{cursor:"pointer"},checked:C().do_sample,onChange:e=>_({do_sample:!!e.target.checked}),className:"mt-2",type:"checkbox",id:"doSample",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Do sample ( Bool )"})})})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Top 'P' - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"top_p",type:"number",value:C().top_p,onChange:e=>{const n=parseFloat(e.target.value)||0;_({top_p:n<0?0:n})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Top 'K' - ",(0,p.jsx)("strong",{children:"\xa0Int"})]}),(0,p.jsx)(m.j,{placeholder:"top_k",type:"number",value:C().top_k,onChange:e=>{const n=parseInt(e.target.value)||0;_({top_k:n<0?0:n})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Repetition penalty - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"repetition_penalty",type:"number",value:C().repetition_penalty,onChange:e=>{const n=parseFloat(e.target.value)||0;_({repetition_penalty:n<1e-6?1e-6:n})}})]})}),(0,p.jsx)(i.b,{cm:6,children:(0,p.jsxs)(d.Y,{className:"mb-3",children:[(0,p.jsxs)(u.w,{style:{width:205},children:["Length penalty - ",(0,p.jsx)("strong",{children:"\xa0Float"})]}),(0,p.jsx)(m.j,{placeholder:"length_penalty",type:"number",value:C().length_penalty,onChange:e=>{const n=parseFloat(e.target.value)||0;_({length_penalty:n<0?0:n})}})]})})]}),(0,p.jsxs)(c.r,{children:[(0,p.jsx)(i.b,{cm:6,children:(0,p.jsx)(h.E,{style:{cursor:"pointer"},checked:k().onlyNewTokens,onChange:e=>w({onlyNewTokens:e.target.checked}),className:"mt-2",type:"checkbox",id:"onlyNewTokensCheck",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Only return new tokens ( or include prompt )"})})}),(0,p.jsx)(i.b,{cm:6,children:s&&(0,p.jsx)(h.E,{style:{cursor:"pointer"},checked:k().streamResponse,onChange:e=>w({streamResponse:e.target.checked}),className:"mt-2",type:"checkbox",id:"isStreamResponse",label:(0,p.jsx)("span",{style:{cursor:"pointer"},children:"Stream tokens as they are being generated ( or all at once )"})})})]}),(0,p.jsx)("div",{className:"invalid-feedback d-block",children:1!==C().num_beams&&"Multiple beams do not support streaming!"})]})]})}},30218:(e,n,s)=>{s.d(n,{Z:()=>g});var t=s(72791),o=s(6332),r=s(55087),l=s(77618),a=s(30734),c=s(45471),i=s(22618),d=s(6265),u=s(84135),m=s(33906),h=s(50436),p=s(59434),x=s(80184);const g=e=>{let{requestId:n,response:s}=e;const[g,j]=(0,t.useState)(!1),v=(0,p.v9)((e=>{let{theme:n}=e;return"auto"===n?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n})),b={code:e=>{let{node:n,...s}=e;return(0,x.jsx)("span",{children:(0,x.jsx)(u.Z,{language:s.language,style:"dark"===v?m.Z:h.Z,children:s.children})})}};return(0,x.jsxs)(r.x,{className:"mb-5 ",children:[(0,x.jsx)(l.b,{children:(0,x.jsxs)(a.r,{children:[(0,x.jsxs)(c.b,{sm:8,children:[(0,x.jsx)("div",{children:"Response to requestID:"}),(0,x.jsx)("small",{children:n})]}),(0,x.jsx)(c.b,{sm:4,children:(0,x.jsx)(i.u,{size:"sm",color:g?"info":"light",className:"float-end mt-2",onClick:()=>j(!g),children:g?"View markdown":"View raw response"})})]})}),(0,x.jsx)(d.s,{children:g?(0,x.jsx)("span",{className:"markdown-llm",children:s}):(0,x.jsx)(o.U,{components:b,skipHtml:!0,className:"markdown-llm",children:s.replace(/ /g,"\xa0")})})]})}},99840:(e,n,s)=>{s.d(n,{Z:()=>r});var t=s(72791),o=s(80184);const r=function(){const[e,n]=(0,t.useState)(0);return(0,t.useEffect)((()=>{const e=(new Date).getTime(),s=setInterval((()=>{n((n=>(new Date).getTime()-e))}),99);return()=>clearInterval(s)}),[]),(0,o.jsx)(o.Fragment,{children:(e/1e3).toFixed(3)})}},80865:(e,n,s)=>{s.r(n),s.d(n,{default:()=>S});var t=s(72791),o=s(12117),r=s(55087),l=s(77618),a=s(22618),c=s(54261),i=s(80184);const d=e=>{switch(e){case"connecting":return"yellow";case"connected":return"green";case"closed":return"gray";case"error":return"red";default:return""}},u={},m=e=>{let{wsUrl:n,onConnecting:s=(()=>{}),onConnect:o=(()=>{}),onError:m=(()=>{}),onClose:h=(()=>{}),onMessage:p=(()=>{}),onStatus:x=(()=>{})}=e;const[g,j]=(0,t.useState)((0,c.Z)()),[v,b]=(0,t.useState)(null),[C,k]=(0,t.useState)("connecting");u[g]={onConnecting:s,onConnect:o,onError:m,onClose:h,onMessage:p,onStatus:x};const y=e=>{var n;let s=e.data;try{s=JSON.parse(e.data)}catch(t){}null===(n=u[g])||void 0===n||n.onMessage(s,e)},_=e=>{e&&(e.removeEventListener("message",y),e.close(),b(null))},w=e=>{k(e),x(e)};return(0,t.useEffect)((()=>{var e;const s=new WebSocket(n);return w("connecting"),s.status="connecting",b(s),null===(e=u[g])||void 0===e||e.onConnecting(s,g),s.addEventListener("open",(function(e){var n;w("connected"),s.status="connected",null===(n=u[g])||void 0===n||n.onConnect(s,g)})),s.addEventListener("close",(function(e){var n;"connecting"!==s.status&&"closing"!==s.status&&w("closed"),s.status="closed",null===(n=u[g])||void 0===n||n.onClose(s,g)})),s.addEventListener("error",(function(e){var n;s.status="error",w("error"),null===(n=u[g])||void 0===n||n.onError(s,g)})),s.addEventListener("message",y),()=>{delete u[g],_(v)}}),[g]),(0,i.jsx)(r.x,{className:"mb-3 ",children:(0,i.jsxs)(l.b,{style:{lineHeight:"2rem"},children:["Websocket Status :\xa0",(0,i.jsx)("strong",{style:{color:d(C)},children:C}),"connected"===C&&(0,i.jsx)(a.u,{size:"sm",color:"danger",className:"float-end ms-3",onClick:()=>_(v),children:"Close"}),("error"===C||"connected"===C)&&(0,i.jsx)(a.u,{size:"sm",color:"secondary",className:"float-end ms-3",onClick:()=>{v.status="closing",j((0,c.Z)())},children:"Reconnect"}),("closed"===C||"connecting"===C)&&(0,i.jsx)(a.u,{size:"sm",disabled:"connecting"===C,color:"success",className:"float-end ms-3",onClick:()=>j((0,c.Z)()),children:"closed"===C?"Connect":"Connecting..."})]})})};var h=s(30734),p=s(45471),x=s(27316),g=s(71987),j=s(95294),v=s(25512),b=s(26775),C=s(52424),k=s(40368),y=s(30218),_=s(99840);const w=window.location.href.split("/")[0]+"//"+window.location.host,f="".concat({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL||w,"/api/ws").replace(/^http/i,"ws"),S=()=>{const[e,n]=(0,t.useState)({}),[s,l]=(0,t.useState)(null),[d,u]=(0,t.useState)("connecting"),[w,S]=(0,t.useState)([{prompt:"[INST] Generate a very long poem about 1000 cats [/INST]\n\n",request_id:(0,c.Z)(),response:"",id:(0,c.Z)()}]),[N,E]=(0,t.useState)(!1),[T,q]=(0,t.useState)(!1),[I,R]=(0,t.useState)(!1),[L,Z]=(0,t.useState)(!1),[F,D]=(0,t.useState)(!1),[O,A]=(0,t.useState)(!1),[P,Y]=(0,t.useState)([]),[M,W]=(0,t.useState)(0),[G,U]=(0,t.useState)(0),[z,H]=(0,t.useState)(0),[B,K]=(0,t.useState)(!0),[V,J]=(0,t.useState)(0),[Q,X]=(0,t.useState)("");(0,t.useEffect)((()=>{!T||!O||I||N||V?E(!1):se()}),[G]);const $=()=>{l(null),ne()},ee=(e,n)=>{const s=w.findIndex((n=>n.id===e));w[s]={...w[s],...n},S([...w])},ne=()=>{E(!0),D(!1),R(!1),Z(!1)},se=n=>{var t,o;s&&(R(!0),O||(Y([]),S([...w.map((e=>(e.response="",e)))])),s.send(JSON.stringify({prompts:w.map((e=>{let{prompt:n,request_id:s}=e;return{request_id:s,prompt:n}})),generation_config:null===e||void 0===e?void 0:e.llmConfig,only_new_tokens:!(null===e||void 0===e||null===(t=e.requestConfig)||void 0===t||!t.onlyNewTokens),stream_response:!(null===e||void 0===e||null===(o=e.requestConfig)||void 0===o||!o.streamResponse)})),O?window.scrollLock=null!==n&&void 0!==n?n:window.scrollLock:window.setTimeout((()=>window.scrollLock=null!==n&&void 0!==n?n:window.scrollLock),250))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m,{wsUrl:f,onMessage:n=>{var s;if(!n.length)return void console.log("Got empty events array, this is normal...");const t=n[0].type,o=n.reduce(((e,n)=>(e[n.request_id]=n,e)),{});switch(t){case"ACCEPTED":D(!0);break;case"STARTED":H((new Date).getTime()),D(!1);break;case"INITIALIZED":I&&(R(!1),Z(!0)),null!==e&&void 0!==e&&null!==(s=e.requestConfig)&&void 0!==s&&s.onlyNewTokens||S([...w.map((e=>{var n;return e.response=(null===(n=o[e.request_id])||void 0===n?void 0:n.text)||"",e}))]);break;case"PROGRESS":I&&(R(!1),Z(!0)),S([...w.map((e=>{var n;return e.response+=(null===(n=o[e.request_id])||void 0===n?void 0:n.text)||"",e}))]);break;case"COMPLETE":R(!1),Z(!1),L||S([...w.map((n=>{var s,t,r;null!==e&&void 0!==e&&null!==(s=e.requestConfig)&&void 0!==s&&s.onlyNewTokens?n.response+=(null===(t=o[n.request_id])||void 0===t?void 0:t.text)||"":n.response=(null===(r=o[n.request_id])||void 0===r?void 0:r.text)||"";return n}))]);const r=n.every((e=>{let{is_eos:n}=e;return n}));A(!r);const l=(new Date).getTime()-z;W(l),Y([...P,l]),U(G+1);break;case"ERROR":R(!1),Z(!1),D(!1),J(!0),X(n[0].error);break;default:console.warn("Type ".concat(t," is not handled!"))}},onConnect:(e,n)=>{l(e)},onStatus:e=>u(e),onClose:$,onError:$}),(0,i.jsx)(o.Z,{config:e,onChange:e=>n(e),showStream:!0}),(0,i.jsx)(h.r,{children:w.map(((e,n)=>{let{prompt:s,request_id:t,id:o}=e;return(0,i.jsx)(p.b,{sm:1===w.length?12:6,className:"mt-4",children:(0,i.jsxs)(r.x,{children:[(0,i.jsxs)(x.Y,{children:[(0,i.jsx)(g.w,{children:"RequestId"}),(0,i.jsx)(j.j,{disabled:I||L||O,placeholder:"request_id",type:"text",value:t,onChange:e=>ee(o,{request_id:e.target.value})}),n>0&&(0,i.jsx)(a.u,{color:"danger",disabled:O,onClick:()=>(e=>{const n=w.findIndex((n=>n.id===e));w.splice(n,1),S([...w])})(o),children:(0,i.jsx)("strong",{children:"Clear"})})]}),(0,i.jsx)(v.P,{placeholder:"[INST] Generate a very long poem about 1000 cats [/INST]\\n\\n",disabled:I||O,value:s,invalid:!!V||!s,onChange:e=>ee(o,{prompt:e.target.value}),id:"exampleFormControlTextarea1",rows:10})]})},"batch-prompt-".concat(o))}))}),!!V&&(0,i.jsx)("div",{className:"invalid-feedback d-block mt-2",children:V&&(Q||"Error generating a response, check your console")}),P.length?(0,i.jsx)(b.L,{htmlFor:"exampleFormControlTextarea1",className:"mt-3",children:(0,i.jsx)("strong",{children:"Response time history: "})}):"",(0,i.jsx)("div",{className:"pb-3",style:{overflow:"auto",whiteSpace:"nowrap"},children:P.length?P.map(((e,n)=>(0,i.jsxs)(C.C,{color:"dark",shape:"rounded-pill",className:"me-2",children:[(e/1e3).toFixed(3)," s"]},"badge-".concat(n,"-").concat(e)))):""}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(a.u,{color:"primary",disabled:I||L||O,onClick:()=>{S([...w,{request_id:(0,c.Z)(),prompt:"",id:(0,c.Z)()}])},children:[" ","+"," "]}),(0,i.jsx)(a.u,{className:"ms-3",color:"primary",disabled:"connected"!==d||I||L||!w.every((e=>{let{prompt:n}=e;return!!n})),onClick:()=>se(B&&w.length<3),children:N&&(I||L||F)?"Stopping...":F?"In Queue...":I?"Waiting...":L?"Streaming...":O?"Continue":"Send Prompt"}),O&&!I&&!L&&" or ",O&&!I&&!L&&(0,i.jsx)(a.u,{color:"secondary",disabled:I||L,onClick:()=>{E(!1),S(w.map((e=>({...e,request_id:(0,c.Z)(),response:""})))),Y([]),J(0),X(""),R(!1),D(!1),A(!1)},children:"reset"}),I||L?(0,i.jsxs)(b.L,{children:[(0,i.jsx)("strong",{children:"\xa0\xa0Segment time:\xa0"}),(0,i.jsx)(_.Z,{})," seconds"]}):M?(0,i.jsxs)(b.L,{children:[(0,i.jsx)("strong",{children:"\xa0\xa0Generation:\xa0"}),P.reduce(((e,n)=>e+n),0)/1e3," seconds"]}):"",(0,i.jsx)(a.u,{color:"secondary",className:"float-end ms-3",disabled:!T,onClick:()=>E(!0),children:"Stop"}),(0,i.jsx)(a.u,{color:"secondary",className:"float-end",disabled:!I&&!L,onClick:ne,children:"Abort"}),"\xa0\xa0"]}),"connected"!==d&&(0,i.jsx)("div",{className:"valid-feedback d-block mt-1 mb-3",children:"Websocket is not connected"}),(0,i.jsx)(k.E,{style:{cursor:"pointer"},checked:B&&w.length<3,disabled:w.length>2,onChange:e=>K(e.target.checked),className:"mt-2",type:"checkbox",id:"setAutoScroll",label:(0,i.jsx)("span",{style:{cursor:"pointer"},children:"Auto scroll to follow the generated response"})}),(0,i.jsx)(k.E,{style:{cursor:"pointer"},checked:T,disabled:I||L,onChange:e=>q(e.target.checked),className:"mt-2",type:"checkbox",id:"autoContinueCheck",label:(0,i.jsx)("span",{style:{cursor:"pointer"},children:"Automatically continue prompt generation when didnt reach EOS"})}),(0,i.jsx)(h.r,{children:w.map((e=>{let{id:n,request_id:s,response:t}=e;return(0,i.jsx)(p.b,{sm:1===w.length?12:6,className:"mt-4",children:t&&(0,i.jsx)(y.Z,{requestId:s,response:t||""})},"response-".concat(n))}))})]})}}}]);
//# sourceMappingURL=865.9e51b625.chunk.js.map