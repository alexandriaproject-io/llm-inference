"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[184],{22184:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Y});var n=t(72791),l=t(48113),r=t(55087),o=t(77618),a=t(22618),c=t(6265),i=t(30734),d=t(45471),h=t(27316),m=t(71987),p=t(95294),u=t(40368),x=t(26775),j=t(25512),g=t(2328),b=t(52424),w=t(80184);const y=function(){const[e,s]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e=(new Date).getTime(),t=setInterval((()=>{s((s=>(new Date).getTime()-e))}),99);return()=>clearInterval(t)}),[]),(0,w.jsx)(w.Fragment,{children:(e/1e3).toFixed(3)})};var _=t(54261),k=t(6332),S=t(84135),v=t(92510),C=t(63564),N=t(59434);const T="".concat({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL||"","/api/generate-one");function f(e,s,t){return e.endsWith(s)?e.slice(0,-s.length)+t:e}let E=!1,F=window.scrollY;window.addEventListener("scroll",(e=>{E?window.scrollY<F&&(E=!1):E=document.body.offsetHeight-(window.innerHeight+window.scrollY)<50,F=window.scrollY}));const I=()=>{E&&window.scrollY<document.body.scrollHeight&&window.scrollTo({top:document.body.scrollHeight,behavior:"auto"});let e=document.body.scrollHeight-window.scrollY;e=e<100?100:e>250?250:e,window.setTimeout(I,E?e:100)};window.setTimeout(I,0);const Y=()=>{const[e,s]=(0,n.useState)((0,_.Z)()),[t,F]=(0,n.useState)("[INST] Generate a very long poem about 1000 cats [/INST]\n\n"),[I,Y]=(0,n.useState)(!1),[A,D]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!0),[H,L]=(0,n.useState)(!0),[P,W]=(0,n.useState)(!0),[Z,B]=(0,n.useState)(""),[G,K]=(0,n.useState)(null),[U,q]=(0,n.useState)(0),[M,V]=(0,n.useState)([]),[z,J]=(0,n.useState)(0),[Q,X]=(0,n.useState)(""),[$,ee]=(0,n.useState)(!1),[se,te]=(0,n.useState)(!1),[ne,le]=(0,n.useState)(!1),[re,oe]=(0,n.useState)(!1),[ae,ce]=(0,n.useState)({num_beams:1,do_sample:!0,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1}),ie=(0,N.v9)((e=>{let{theme:s}=e;return"auto"===s?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":s})),de={code:e=>{let{node:s,...t}=e;return(0,w.jsx)("span",{children:(0,w.jsx)(S.Z,{language:t.language,style:"dark"===ie?C.Z:v.Z,children:t.children})})}};(0,n.useEffect)((()=>{!A||!re||se||$||I||z?Y(!1):he()}),[U]);const he=async s=>{re?E=null!==s&&void 0!==s?s:E:(B(""),window.setTimeout((()=>E=null!==s&&void 0!==s?s:E),250)),ee(!0),te(!1),Y(!1),X(""),J(0),q(0);let n="";re?n=H?Z:"":V([]);let l="";try{const{responseTime:s,response:r}=await async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const l=(new Date).getTime(),r=new AbortController,o=r.signal,a=await fetch(e,{method:"POST",body:JSON.stringify(s),signal:o});n(r);const c=a.body.getReader();for(;;){const{done:e,value:s}=await c.read();if(e)break;t((new TextDecoder).decode(s))}return{response:a,responseTime:(new Date).getTime()-l}}(T,{request_id:e,prompt:t,only_new_tokens:H,stream_response:P,generation_config:ae},(e=>{l=e,n+=e,ee(!1),te(!0),B(n)}),(e=>K(e)));200!==r.status?(J(1),E=!1,R&&window.scrollTo(0,0),B(f(n,l,"")),X(l)):V(re?[...M,s]:[s]),q(s)}catch(r){"AbortError"===r.name?(console.log("Aborting"),J(2)):(console.error(r),J(1),E=!1,R&&window.scrollTo(0,0),B(f(n,l,"")),X(l)),K(null),ee(!1),te(!1),Y(!1)}finally{K(null),ee(!1),te(!1);const e=n.trimEnd().endsWith("</s>");oe(!e),e&&Y(!1)}};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(l.l,{className:"pb-5",children:[(0,w.jsxs)(r.x,{className:"mb-3 ",children:[(0,w.jsxs)(o.b,{children:["Generation Config:",(0,w.jsx)(a.u,{color:"secondary",size:"sm",className:"float-end",onClick:()=>{ce({num_beams:1,do_sample:!0,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1}),L(!0),W(!0)},children:"reset defaults"})]}),(0,w.jsxs)(c.s,{children:[(0,w.jsx)("small",{children:(0,w.jsx)("br",{})}),(0,w.jsxs)(i.r,{children:[(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Temperature - ",(0,w.jsx)("strong",{children:"\xa0Float"})]}),(0,w.jsx)(p.j,{placeholder:"temperature",type:"number",value:ae.temperature,onChange:e=>{const s=parseFloat(e.target.value)||0;ce({...ae,temperature:s<0?0:s})}})]})}),(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Max new Tokens - ",(0,w.jsx)("strong",{children:"\xa0Int"})]}),(0,w.jsx)(p.j,{placeholder:"max_new_tokens",type:"number",value:ae.max_new_tokens,onChange:e=>{const s=parseInt(e.target.value)||0;ce({...ae,max_new_tokens:s<1?1:s})}})]})})]}),(0,w.jsxs)(i.r,{children:[(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Number of Beams - ",(0,w.jsx)("strong",{children:"\xa0Int"})]}),(0,w.jsx)(p.j,{placeholder:"num_beams",type:"number",value:ae.num_beams,onChange:e=>{const s=parseInt(e.target.value)||0;ce({...ae,num_beams:s<1?1:s})}})]})}),(0,w.jsx)(d.b,{cm:6,children:(0,w.jsx)(h.Y,{className:"mb-3",children:(0,w.jsx)(u.E,{style:{cursor:"pointer"},checked:ae.do_sample,onChange:e=>ce({...ae,do_sample:!!e.target.checked}),className:"mt-2",type:"checkbox",id:"doSample",label:(0,w.jsx)("span",{style:{cursor:"pointer"},children:"Do sample ( Bool )"})})})})]}),(0,w.jsxs)(i.r,{children:[(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Top 'P' - ",(0,w.jsx)("strong",{children:"\xa0Float"})]}),(0,w.jsx)(p.j,{placeholder:"top_p",type:"number",value:ae.top_p,onChange:e=>{const s=parseFloat(e.target.value)||0;ce({...ae,top_p:s<0?0:s})}})]})}),(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Top 'K' - ",(0,w.jsx)("strong",{children:"\xa0Int"})]}),(0,w.jsx)(p.j,{placeholder:"top_k",type:"number",value:ae.top_k,onChange:e=>{const s=parseInt(e.target.value)||0;ce({...ae,top_k:s<0?0:s})}})]})})]}),(0,w.jsxs)(i.r,{children:[(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Repetition penalty - ",(0,w.jsx)("strong",{children:"\xa0Float"})]}),(0,w.jsx)(p.j,{placeholder:"repetition_penalty",type:"number",value:ae.repetition_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;ce({...ae,repetition_penalty:s<1e-6?1e-6:s})}})]})}),(0,w.jsx)(d.b,{cm:6,children:(0,w.jsxs)(h.Y,{className:"mb-3",children:[(0,w.jsxs)(m.w,{style:{width:205},children:["Length penalty - ",(0,w.jsx)("strong",{children:"\xa0Float"})]}),(0,w.jsx)(p.j,{placeholder:"length_penalty",type:"number",value:ae.length_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;ce({...ae,length_penalty:s<0?0:s})}})]})})]}),(0,w.jsxs)(i.r,{children:[(0,w.jsx)(d.b,{cm:6,children:(0,w.jsx)(u.E,{style:{cursor:"pointer"},checked:H,disabled:$||se,onChange:e=>L(e.target.checked),className:"mt-2",type:"checkbox",id:"onlyNewTokensCheck",label:(0,w.jsx)("span",{style:{cursor:"pointer"},children:"Only return new tokens ( or include prompt )"})})}),(0,w.jsx)(d.b,{cm:6,children:(0,w.jsx)(u.E,{style:{cursor:"pointer"},checked:P,disabled:$||se,onChange:e=>W(e.target.checked),className:"mt-2",type:"checkbox",id:"isStreamResponse",label:(0,w.jsx)("span",{style:{cursor:"pointer"},children:"Stream tokens as they are being generated ( or all at once )"})})})]}),(0,w.jsx)("div",{className:"invalid-feedback d-block",children:1!==ae.num_beams&&"Multiple beams do not support streaming!"})]})]}),(0,w.jsxs)("div",{className:"mb-3",children:[(0,w.jsxs)(x.L,{htmlFor:"exampleFormControlTextarea1",children:[(0,w.jsx)("strong",{children:"Write your prompt "}),"- ",(0,w.jsxs)("small",{children:["RequestID: ",e]})]}),(0,w.jsx)(j.P,{placeholder:"[INST] Generate a very long poem about 1000 cats [/INST]\\n\\n",disabled:$||se||re,value:t,invalid:!!z,onChange:e=>F(e.target.value),id:"exampleFormControlTextarea1",rows:10}),(0,w.jsx)(g.C,{invalid:!0,children:2===z?"Aborting might cause some data to be lost, its best to reset after aborting!":Q||"Error generating a response, check your console"})]}),M.length?(0,w.jsx)(x.L,{htmlFor:"exampleFormControlTextarea1",children:(0,w.jsx)("strong",{children:"Response time history: "})}):"",(0,w.jsx)("div",{className:"pb-3",style:{overflow:"auto",whiteSpace:"nowrap"},children:M.length?M.map(((e,s)=>(0,w.jsxs)(b.C,{color:"dark",shape:"rounded-pill",className:"me-2",children:[(e/1e3).toFixed(3)," s"]},"badge-".concat(s,"-").concat(e)))):""}),(0,w.jsxs)("div",{className:"mb-3 ",children:[(0,w.jsx)(a.u,{color:"primary",disabled:$||se||!t,onClick:()=>he(R),children:I&&($||se)?"Stopping...":$?"Waiting...":se?"Streaming...":re?"Continue":"Send Prompt"}),re&&!$&&!se&&" or ",!$&&!se&&re&&(0,w.jsx)(a.u,{color:"secondary",disabled:$||se,onClick:()=>{s((0,_.Z)()),Y(!1),B(""),K(null),q(0),V([]),J(0),X(""),ee(!1),te(!1),oe(!1)},children:"reset"}),$||se?(0,w.jsxs)(x.L,{children:[(0,w.jsx)("strong",{children:"\xa0\xa0Segment time:\xa0"}),(0,w.jsx)(y,{})," seconds"]}):U?(0,w.jsxs)(x.L,{children:[(0,w.jsx)("strong",{children:"\xa0\xa0Generation:\xa0"}),M.reduce(((e,s)=>e+s),0)/1e3," seconds"]}):"",(0,w.jsx)(a.u,{color:"secondary",className:"float-end ms-3",disabled:!A,onClick:()=>Y(!0),children:"Stop"}),(0,w.jsx)(a.u,{color:"secondary",className:"float-end",disabled:!$&&!se,onClick:()=>{Y(!0),console.log(G),G&&G.abort()},children:"Abort"}),"\xa0\xa0"]}),(0,w.jsx)(u.E,{style:{cursor:"pointer"},checked:R,onChange:e=>O(e.target.checked),className:"mt-2",type:"checkbox",id:"setAutoScroll",label:(0,w.jsx)("span",{style:{cursor:"pointer"},children:"Auto scroll to follow the generated response"})}),(0,w.jsx)(u.E,{style:{cursor:"pointer"},checked:A,disabled:$||se,onChange:e=>D(e.target.checked),className:"mt-2",type:"checkbox",id:"autoContinueCheck",label:(0,w.jsx)("span",{style:{cursor:"pointer"},children:"Automatically continue prompt generation when didnt reach EOS"})})]}),Z&&(0,w.jsxs)(r.x,{className:"mb-5 ",children:[(0,w.jsxs)(o.b,{children:["Response to requestID ",e,":",(0,w.jsx)(a.u,{color:ne?"info":"light",className:"float-end",onClick:()=>le(!ne),children:ne?"View markdown":"View raw response"})]}),(0,w.jsx)(c.s,{children:ne?(0,w.jsx)("span",{className:"markdown-llm",children:Z}):(0,w.jsx)(k.U,{components:de,skipHtml:!0,className:"markdown-llm",children:Z.replace(/ /g,"\xa0")})})]})]})}}}]);
//# sourceMappingURL=184.d8ef15b8.chunk.js.map