"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[184],{22184:(e,s,t)=>{t.r(s),t.d(s,{default:()=>E});var n=t(72791),a=t(48113),r=t(55087),l=t(77618),o=t(22618),c=t(6265),i=t(30734),d=t(45471),m=t(27316),h=t(71987),p=t(95294),u=t(40368),x=t(26775),j=t(25512),g=t(2328),b=t(52424),_=t(80184);const y=function(){const[e,s]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e=(new Date).getTime(),t=setInterval((()=>{s((s=>(new Date).getTime()-e))}),99);return()=>clearInterval(t)}),[]),(0,_.jsx)(_.Fragment,{children:e/1e3})};var k=t(54261),w=t(6332),S=t(84135),v=t(92510),C=t(63564),N=t(59434);const f="".concat({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL||"","/api/generate-one");function T(e,s,t){return e.endsWith(s)?e.slice(0,-s.length)+t:e}const E=()=>{const[e,s]=(0,n.useState)((0,k.Z)()),[t,E]=(0,n.useState)("[INST] Generate a very long poem about 1000 cats [/INST]\n\n"),[F,I]=(0,n.useState)(!1),[D,A]=(0,n.useState)(!1),[O,R]=(0,n.useState)(!0),[P,Y]=(0,n.useState)(""),[L,W]=(0,n.useState)(null),[Z,B]=(0,n.useState)(0),[G,H]=(0,n.useState)([]),[K,U]=(0,n.useState)(0),[q,M]=(0,n.useState)(""),[V,z]=(0,n.useState)(!1),[J,Q]=(0,n.useState)(!1),[X,$]=(0,n.useState)(!1),[ee,se]=(0,n.useState)(!1),[te,ne]=(0,n.useState)({num_beams:1,do_sample:!1,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1}),ae=(0,N.v9)((e=>{let{theme:s}=e;return"auto"===s?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":s})),re={code:e=>{let{node:s,...t}=e;return(0,_.jsx)("span",{children:(0,_.jsx)(S.Z,{language:t.language,style:"dark"===ae?C.Z:v.Z,children:t.children})})}};(0,n.useEffect)((()=>{!D||!ee||J||V||F||K?I(!1):le()}),[Z]);const le=async()=>{z(!0),Q(!1),I(!1),M(""),U(0),B(0);let s="";ee?s=O?P:"":H([]);let n="";try{const{responseTime:a,response:r}=await async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const a=(new Date).getTime(),r=new AbortController,l=r.signal,o=await fetch(e,{method:"POST",body:JSON.stringify(s),signal:l});n(r);const c=o.body.getReader();for(;;){const{done:e,value:s}=await c.read();if(e)break;t((new TextDecoder).decode(s))}return{response:o,responseTime:(new Date).getTime()-a}}(f,{request_id:e,prompt:t,only_new_tokens:O,generation_config:te},(e=>{n=e,s+=e,z(!1),Q(!0),Y(s)}),(e=>W(e)));200!==r.status?(U(1),Y(T(s,n,"")),M(n)):H(ee?[...G,a]:[a]),B(a)}catch(a){"AbortError"===a.name?(console.log("Aborting"),U(2)):(console.error(a),U(1),Y(T(s,n,"")),M(n)),W(null),z(!1),Q(!1),I(!1)}finally{W(null),z(!1),Q(!1);const e=s.trimEnd().endsWith("</s>");se(!e),e&&I(!1)}};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(a.l,{className:"pb-3",children:[(0,_.jsxs)(r.x,{className:"mb-3 ",children:[(0,_.jsxs)(l.b,{children:["Generation Config:",(0,_.jsx)(o.u,{color:"secondary",size:"sm",className:"float-end",onClick:()=>ne({num_beams:1,do_sample:!1,temperature:1,top_p:1,top_k:50,max_new_tokens:100,repetition_penalty:1,length_penalty:1}),children:"reset defaults"})]}),(0,_.jsxs)(c.s,{children:[(0,_.jsx)("small",{children:(0,_.jsx)("br",{})}),(0,_.jsxs)(i.r,{children:[(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Temperature - ",(0,_.jsx)("strong",{children:"\xa0Float"})]}),(0,_.jsx)(p.j,{placeholder:"temperature",type:"number",value:te.temperature,onChange:e=>{const s=parseFloat(e.target.value)||0;ne({...te,temperature:s<0?0:s})}})]})}),(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Max new Tokens - ",(0,_.jsx)("strong",{children:"\xa0Int"})]}),(0,_.jsx)(p.j,{placeholder:"max_new_tokens",type:"number",value:te.max_new_tokens,onChange:e=>{const s=parseInt(e.target.value)||0;ne({...te,max_new_tokens:s<1?1:s})}})]})})]}),(0,_.jsxs)(i.r,{children:[(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Number of Beams - ",(0,_.jsx)("strong",{children:"\xa0Int"})]}),(0,_.jsx)(p.j,{placeholder:"num_beams",type:"number",value:te.num_beams,onChange:e=>{const s=parseInt(e.target.value)||0;ne({...te,num_beams:s<1?1:s})}})]})}),(0,_.jsx)(d.b,{cm:6,children:(0,_.jsx)(m.Y,{className:"mb-3",children:(0,_.jsx)(u.E,{style:{cursor:"pointer"},checked:te.do_sample,onChange:e=>ne({...te,do_sample:!!e.target.checked}),className:"mt-2",type:"checkbox",id:"doSample",label:(0,_.jsx)("span",{style:{cursor:"pointer"},children:"Do sample ( Bool )"})})})})]}),(0,_.jsxs)(i.r,{children:[(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Top 'P' - ",(0,_.jsx)("strong",{children:"\xa0Float"})]}),(0,_.jsx)(p.j,{placeholder:"top_p",type:"number",value:te.top_p,onChange:e=>{const s=parseFloat(e.target.value)||0;ne({...te,top_p:s<0?0:s})}})]})}),(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Top 'K' - ",(0,_.jsx)("strong",{children:"\xa0Int"})]}),(0,_.jsx)(p.j,{placeholder:"top_k",type:"number",value:te.top_k,onChange:e=>{const s=parseInt(e.target.value)||0;ne({...te,top_k:s<0?0:s})}})]})})]}),(0,_.jsxs)(i.r,{children:[(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Repetition penalty - ",(0,_.jsx)("strong",{children:"\xa0Float"})]}),(0,_.jsx)(p.j,{placeholder:"repetition_penalty",type:"number",value:te.repetition_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;ne({...te,repetition_penalty:s<1e-6?1e-6:s})}})]})}),(0,_.jsx)(d.b,{cm:6,children:(0,_.jsxs)(m.Y,{className:"mb-3",children:[(0,_.jsxs)(h.w,{style:{width:205},children:["Length penalty - ",(0,_.jsx)("strong",{children:"\xa0Float"})]}),(0,_.jsx)(p.j,{placeholder:"length_penalty",type:"number",value:te.length_penalty,onChange:e=>{const s=parseFloat(e.target.value)||0;ne({...te,length_penalty:s<0?0:s})}})]})})]}),(0,_.jsx)("div",{className:"invalid-feedback d-block",children:1!==te.num_beams&&"Multiple beams do not support streaming!"})]})]}),(0,_.jsxs)("div",{className:"mb-3",children:[(0,_.jsxs)(x.L,{htmlFor:"exampleFormControlTextarea1",children:[(0,_.jsx)("strong",{children:"Write your prompt "}),"- ",(0,_.jsxs)("small",{children:["RequestID: ",e]})]}),(0,_.jsx)(j.P,{placeholder:"[INST] Generate a very long poem about 1000 cats [/INST]\\n\\n",disabled:V||J||ee,value:t,invalid:!!K,onChange:e=>E(e.target.value),id:"exampleFormControlTextarea1",rows:10}),(0,_.jsx)(g.C,{invalid:!0,children:2===K?"Aborting might cause some data to be lost, its best to reset after aborting!":q||"Error generating a response, check your console"}),G.length?G.map(((e,s)=>(0,_.jsxs)(b.C,{color:"dark",shape:"rounded-pill",className:"me-2 mt-3",children:[e/1e3," s"]},"badge-".concat(s,"-").concat(e)))):""]}),(0,_.jsxs)("div",{className:"mb-3 ",children:[(0,_.jsx)(o.u,{color:"primary",disabled:V||J||!t,onClick:le,children:F?"Stopping...":V?"Waiting...":J?"Streaming...":ee?"Continue":"Send Prompt"}),ee&&!V&&!J&&" or ",!V&&!J&&ee&&(0,_.jsx)(o.u,{color:"secondary",disabled:V||J,onClick:()=>{s((0,k.Z)()),I(!1),Y(""),W(null),B(0),H([]),U(0),M(""),z(!1),Q(!1),se(!1)},children:"reset"}),V||J?(0,_.jsxs)(x.L,{children:[(0,_.jsx)("strong",{children:"\xa0\xa0Segment time:\xa0"}),(0,_.jsx)(y,{})," seconds"]}):Z?(0,_.jsxs)(x.L,{children:[(0,_.jsx)("strong",{children:"\xa0\xa0Generation:\xa0"}),G.reduce(((e,s)=>e+s),0)/1e3," seconds"]}):"",(0,_.jsx)(o.u,{color:"secondary",className:"float-end ms-3",disabled:!V&&!J||F,onClick:()=>I(!0),children:"Stop"}),(0,_.jsx)(o.u,{color:"secondary",className:"float-end",disabled:!V&&!J,onClick:()=>{I(!0),console.log(L),L&&L.abort()},children:"Abort"}),"\xa0\xa0"]}),(0,_.jsx)(u.E,{style:{cursor:"pointer"},checked:D,disabled:V||J,onChange:e=>A(e.target.checked),className:"mt-2",type:"checkbox",id:"autoContinueCheck",label:(0,_.jsx)("span",{style:{cursor:"pointer"},children:"Automatically continue prompt generation when didnt reach EOS"})}),(0,_.jsx)(u.E,{style:{cursor:"pointer"},checked:O,disabled:V||J,onChange:e=>R(e.target.checked),className:"mt-2",type:"checkbox",id:"onlyNewTokensCheck",label:(0,_.jsx)("span",{style:{cursor:"pointer"},children:"Only return new tokens, if disabled returns response including prompt"})})]}),P&&(0,_.jsxs)(r.x,{className:"mb-5 ",children:[(0,_.jsxs)(l.b,{children:["Response to requestID ",e,":",(0,_.jsx)(o.u,{color:X?"info":"light",className:"float-end",onClick:()=>$(!X),children:X?"View markdown":"View raw response"})]}),(0,_.jsx)(c.s,{children:X?(0,_.jsx)("span",{className:"markdown-llm",children:P}):(0,_.jsx)(w.U,{components:re,skipHtml:!0,className:"markdown-llm",children:P.replace(/ /g,"\xa0")})})]})]})}}}]);
//# sourceMappingURL=184.479d9172.chunk.js.map